library(pracma)
library(ggplot2)

ADC_256x_TBL = c(
  14289,14199,14105,14009,13911,13809,13705,13599,13489,13378,    # -20..-11
  13263,13146,13025,12903,12778,12651,12521,12389,12255,12119,    # -10..-01
  11981,11842,11701,11558,11413,11267,11119,10970,10820,10669,    #  00..  9
  10516,10363,10209,10054, 9899, 9743, 9587, 9431, 9275, 9119,    #  10.. 19
  8963, 8808, 8653, 8499, 8345, 8192, 8039, 7887, 7736, 7586,     #  20.. 29
  7438, 7290, 7145, 7000, 6857, 6716, 6577, 6439, 6303, 6168,     #  30.. 39
  6036, 5905, 5776, 5649, 5523, 5400, 5279, 5159, 5042, 4927,     #  40.. 49
  4814, 4703, 4593, 4486, 4381, 4279, 4178, 4079, 3982, 3887,     #  50.. 59
  3794, 3705, 3617, 3531, 3448, 3366, 3286, 3208, 3132, 3057,     #  60.. 69
  2984, 2913, 2843, 2775, 2709, 2644, 2580, 2519, 2458, 2400,     #  70.. 79
  2342, 2287, 2232, 2179, 2127, 2077, 2028, 1980, 1933, 1888,     #  80.. 89
  1843, 1800, 1757, 1716, 1675, 1636, 1597, 1560, 1524, 1488,     #  90.. 99
  1453                                                            # 100

)
ADC_256x_TBL = sort(ADC_256x_TBL)
Temp_TBL = 100:-20
y3 = (-7.472127e-11)*ADC_256x_TBL^3 + (2.045783e-06)*ADC_256x_TBL^2 + (-2.440781e-02)*ADC_256x_TBL + (1.280950e+02)
y4 = (6.094109e-15)*ADC_256x_TBL^4 + (-2.628095e-10)*ADC_256x_TBL^3 + (3.989258e-06)*ADC_256x_TBL^2 + (-3.203260e-02)*ADC_256x_TBL + (1.371492e+02)
y5 = (-1.207967e-18)*ADC_256x_TBL^5 + (5.290034e-14)*ADC_256x_TBL^4 + (-9.292836e-10)*ADC_256x_TBL^3 + (8.246146e-06)*ADC_256x_TBL^2 + (-4.386163e-02)*ADC_256x_TBL + (1.482415e+02)


y2_ra = ((8.378644e-07)*ADC_256x_TBL^2 + (3.263003e-03)*ADC_256x_TBL + (-1.591611e+02))/((1.799811e-08)*ADC_256x_TBL^2 + (-3.962889e-04)*ADC_256x_TBL + (-1.000000e+00))
y3_ra = ((-1.887277e-10)*ADC_256x_TBL^3 + (5.964375e-06)*ADC_256x_TBL^2 + (-2.852329e-02)*ADC_256x_TBL + (-1.899113e+02))/((4.077038e-13)*ADC_256x_TBL^3 + (4.404387e-08)*ADC_256x_TBL^2 + (-8.866561e-04)*ADC_256x_TBL + (-1.000000e+00))
y4_ra = ((-2.443365e-14)*ADC_256x_TBL^4 + (9.399215e-10)*ADC_256x_TBL^3 + (-9.298352e-06)*ADC_256x_TBL^2 + (2.673289e-03)*ADC_256x_TBL + (1.896458e+02)) / ((3.306738e-17)*ADC_256x_TBL^4 + (5.705119e-12)*ADC_256x_TBL^3 + (-1.583454e-07)*ADC_256x_TBL^2 + (7.459337e-04)*ADC_256x_TBL + (1.000000e+00))

res_tab = data.frame(Temp_TBL,ADC_256x_TBL, y3,y4,y5,y2_ra,y3_ra,y4_ra )

ggplot(data  = res_tab)+
  geom_point(aes(x = ADC_256x_TBL,y = y3 ), color=5, size=2)

+
  geom_line(aes(x=Temp_TBL,y=y3 ), color=2)+
  geom_line(aes(x=Temp_TBL,y=y4 ), color=3)+
  geom_line(aes(x=Temp_TBL,y=y5 ), color=4)



plot(Temp_TBL, ADC_256x_TBL)
plot(Temp_TBL, y5)
poly2str(ADC_256x_TBL, svar = "x", smul = "*", d = options("digits")$digits)
polyfit(ADC_256x_TBL,Temp_TBL, 3)
xi <- linspace(1453,14289,  6)
ppcub <- ppfit(ADC_256x_TBL,Temp_TBL, xi, method = "cubic")

rA = rationalfit(ADC_256x_TBL,Temp_TBL, 4, 4); p1 <- rA$p1; p2 <- rA$p2
p1;p2
